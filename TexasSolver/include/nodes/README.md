# Nodes ディレクトリ

## 概要

本ディレクトリには、ゲームツリーを構成する各種ノードクラスのヘッダーファイルが格納されています。TexasSolverのコアデータ構造であり、ポーカーゲームの状態遷移を表現します。

## ファイル

### GameTreeNode.h
全てのノードタイプの基底クラスです。

**主要機能:**
- ゲームラウンドの列挙型定義（FLOP, TURN, RIVER等）
- ノードの深さ管理
- 親子関係の管理
- 仮想関数インターフェースの定義

### ActionNode.h
プレイヤーのアクション（ベット、チェック、フォールド、レイズ）を表すノードです。

**主要機能:**
- 利用可能なアクションのリスト管理
- 各アクションに対応する子ノードへのポインタ
- 現在のプレイヤー情報
- ポットとコミット額の管理
- CFRトレーニング可能オブジェクトの保持

**データ構造:**
- `player`: 現在のアクティブプレイヤー（0または1）
- `actions`: 利用可能なアクション文字列のリスト
- `children`: 各アクションに対応する子ノード
- `trainable`: CFRアルゴリズムで使用するトレーニングデータ

### ChanceNode.h
チャンスイベント（カード配布）を表すノードです。

**主要機能:**
- 配布されるカードの管理
- 確率的な分岐の表現
- 次ラウンドへの遷移

**データ構造:**
- `children`: 各カード配布パターンに対応する子ノード
- `chance_cards`: 配布されるカードのリスト

### ShowdownNode.h
ショーダウン（勝者判定）を表すノードです。

**主要機能:**
- ハンド強度の比較
- ポット分配の計算
- 期待値の算出

**特徴:**
- 両プレイヤーのハンドを公開して勝敗を判定
- タイの場合の処理
- 最終的なペイオフ計算

### TerminalNode.h
ゲームツリーの終端ノード（フォールド等）を表します。

**主要機能:**
- 即座のペイオフ計算
- ゲーム終了状態の表現

**データ構造:**
- `payoff`: 各プレイヤーのペイオフ
- `winner`: 勝者の情報

### GameActions.h
ゲームアクションの定義と列挙型です。

**定義されるアクション:**
- CHECK: チェック
- BET: ベット
- CALL: コール
- RAISE: レイズ
- FOLD: フォールド
- ALLIN: オールイン

## ノードタイプの関係

```
GameTreeNode (基底クラス)
├── ActionNode (プレイヤーアクション)
├── ChanceNode (カード配布)
├── ShowdownNode (勝者判定)
└── TerminalNode (即座の終了)
```

## 使用例

ゲームツリーは以下のような構造を持ちます:

```
ActionNode (フロップ、OOPアクション)
├── [CHECK] → ActionNode (フロップ、IPアクション)
│   ├── [CHECK] → ChanceNode (ターン配布)
│   └── [BET] → ActionNode (フロップ、OOPアクション)
├── [BET] → ActionNode (フロップ、IPアクション)
│   ├── [CALL] → ChanceNode (ターン配布)
│   ├── [RAISE] → ActionNode (フロップ、OOPアクション)
│   └── [FOLD] → TerminalNode (IPの勝利)
└── ...
```

## CFRアルゴリズムとの統合

各`ActionNode`は`Trainable`オブジェクトを保持し、CFRアルゴリズムによって以下が更新されます:
- 累積リグレット（Cumulative Regret）
- 戦略サム（Strategy Sum）
- 現在の戦略（Current Strategy）

これにより、イテレーションを重ねるごとにナッシュ均衡に収束する戦略が計算されます。
